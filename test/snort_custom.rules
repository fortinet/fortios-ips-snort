alert tcp any any -> any any ( sid:01; msg:"test file_data case 1 NO file_data Pure S3"; http_method; content:"GET"; http_uri; content:"insideuri"; content:"insideuri2", distance 0; http_raw_body; content:"insidebody",nocase, depth 102; )
alert tcp any any -> any any ( sid:01; msg:"test file_data case 2 NO file_data Pure S2"; content:"GET"; http_method; content:"insideuri"; http_uri; content:"insideuri2"; http_uri; distance:0; content:"insidebody"; nocase; http_raw_body; depth:102; )
alert tcp any any -> any any ( sid:01; msg:"test file_data case 1 YES file_data Pure S3"; http_method; content:"GET"; http_uri; content:"insideuri"; content:"insideuri2", distance 0; file_data; content:"insidefile"; content:"insidefile2", distance 0; http_raw_body; content:"insidebody",nocase, depth 102; )
alert tcp any any -> any any ( sid:01; msg:"test file_data case 2 YES file_data Pure S2"; content:"GET"; http_method; content:"insideuri"; http_uri; content:"insideuri2"; http_uri; distance:0; file_data; content:"insidefile"; content:"insidefile2", distance 0; content:"insidebody"; nocase;  http_raw_body; depth:102; )
alert tcp any any -> any any ( sid:01; msg:"test file_data case 3 YES file_data Pure S3"; file_data; content:"insidefile"; content:"insidefile2", distance 0; http_method; content:"GET"; http_uri; content:"insideuri"; content:"insideuri2", distance 0; http_raw_body; content:"insidebody",nocase, depth 102; )
alert tcp any any -> any any ( sid:01; msg:"test file_data case 3 YES file_data Pure S2"; file_data; content:"insidefile"; content:"insidefile2", distance 0; content:"GET"; http_method; content:"insideuri"; http_uri; content:"insideuri2"; http_uri; distance:0; content:"insidebody"; nocase;  http_raw_body; depth:102; )
alert tcp any any -> any any ( sid:01; msg:"test pkt_data case 1 NO pkt_data Pure S3"; http_method; content:"GET"; http_uri; content:"insideuri"; content:"insideuri2", distance 0; http_raw_body; content:"insidebody",nocase, depth 102; )
alert tcp any any -> any any ( sid:01; msg:"test pkt_data case 1 NO pkt_data Pure S2"; content:"GET"; http_method; content:"insideuri"; http_uri; content:"insideuri2"; http_uri; distance:0; content:"insidebody"; nocase; http_raw_body; depth:102; )
alert tcp any any -> any any ( sid:01; msg:"test pkt_data case 2 YES pkt_data Pure S3"; http_method; content:"GET"; http_uri; content:"insideuri"; content:"insideuri2", distance 0; pkt_data; content:"insidefile"; content:"insidefile2", distance 0; http_raw_body; content:"insidebody",nocase, depth 102; )
alert tcp any any -> any any ( sid:01; msg:"test pkt_data case 2 YES pkt_data Pure S2"; content:"GET"; http_method; content:"insideuri"; http_uri; content:"insideuri2"; http_uri; distance:0; pkt_data; content:"insidefile"; content:"insidefile2", distance 0; content:"insidebody"; nocase;  http_raw_body; depth:102; )
alert tcp any any -> any any ( sid:01; msg:"test pkt_data case 3 YES pkt_data Pure S3"; pkt_data; content:"insidefile"; content:"insidefile2", distance 0; http_method; content:"GET"; http_uri; content:"insideuri"; content:"insideuri2", distance 0; http_raw_body; content:"insidebody",nocase, depth 102; )
alert tcp any any -> any any ( sid:01; msg:"test pkt_data case 3 YES pkt_data Pure S2"; pkt_data; content:"insidefile"; content:"insidefile2", distance 0; content:"GET"; http_method; content:"insideuri"; http_uri; content:"insideuri2"; http_uri; distance:0; content:"insidebody"; nocase;  http_raw_body; depth:102; )
alert tcp any 123 -> any any ( sid:02; msg:"test port 1 val"; pkt_data; content:"test_header"; )
alert tcp any [123] -> any any ( sid:02; msg:"test port list 1 val"; pkt_data; content:"test_header"; )
alert tcp any [123,333,444] -> any any ( sid:02; msg:"test port list unsupported"; pkt_data; content:"test_header"; )
alert tcp any [123,$HTTP_PORTS,444] -> any any ( sid:02; msg:"test port list w policy var unsupported"; pkt_data; content:"test_header"; )
alert tcp any $HTTP_PORTS -> any any ( sid:02; msg:"test port policy var converted to protocol"; pkt_data; content:"test_header"; )
alert tcp any $CUSTOM_PORTS -> any any ( sid:02; msg:"test port custom policy var removed"; pkt_data; content:"test_header"; )